


## SQL注入_WITH ROLLUP绕过

使用 GROUP BY 的 WITH ROLLUP 字句可以检索出更多的分组聚合信息，它不仅仅能像一般的 GROUP BY 语句那样检索出各组的聚合信息，还能检索出本组类的整体聚合信息。

我们用with rollup 统计，加上用offset偏移，来获取内容，并且能有有内容为NULL.

```sql
mysql> select * from test group by pwd with rollup limit 1 offset 1
;
+-------+--------+
| user  | pwd    |
+-------+--------+
| admin | mypass |
+-------+--------+
1 row in set
mysql> select * from test group by pwd with rollup limit 1 offset 2
;
+-------+------+
| user  | pwd  |
+-------+------+
| admin | NULL |
+-------+------+
1 row in set 
```
```sql
mysql> select * from employee;  
+------+--------+------+------+------+  
| id | name | dep | pos | sal |  
+------+--------+------+------+------+  
| 1 | abcd | 01 | 01 | 1000 |  
| 2 | eefs | 01 | 02 | 2000 |  
| 3 | micro | 02 | 01 | 1500 |  
| 4 | cathey | 02 | 02 | 3000 |  
| 5 | amy | 03 | 01 | 2500 |  
| 6 | lily | 03 | 02 | 2200 |  
| 7 | bobo | 01 | 01 | 2000 |  
| 8 | gray | 01 | 02 | 1900 |  
| 9 | leon | 03 | 02 | 2900 |  
| 10 | sun | 02 | 02 | 1900 |  
+------+--------+------+------+------+  
10 rows in set (0.00 sec)  

mysql> select dep,pos,avg(sal) from employee group by dep,pos with rollup;  
+------+------+-----------+  
| dep | pos | avg(sal) |  
+------+------+-----------+  
| 01 | 01 | 1500.0000 |  
| 01 | 02 | 1950.0000 |  
| 01 | NULL | 1725.0000 |  
| 02 | 01 | 1500.0000 |  
| 02 | 02 | 2450.0000 |  
| 02 | NULL | 2133.3333 |  
| 03 | 01 | 2500.0000 |  
| 03 | 02 | 2550.0000 |  
| 03 | NULL | 2533.3333 |  
| NULL | NULL | 2090.0000 |  
+------+------+-----------+  
10 rows in set (0.00 sec)  
```















